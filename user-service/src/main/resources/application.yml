server:
  port: 8081

spring:
  application:
    name: user-service

  data:
    mongodb:
      uri: mongodb://localhost:27017/animeflix_user
      auto-index-creation: true

    redis:
       url: ${REDIS_URL:rediss://default:AeIjAAIncDEwNzdmMmM3MzEyMTI0ODE1OTk5ZjNkN2ZmNmRhOTE0OHAxNTc4OTE@known-feline-57891.upstash.io:6379}

  codec:
    http:
      legacy:
        response:
          write-content-length: false

# External Services
services:
  anime-catalog:
    url: ${ANIME_CATALOG_URL:http://localhost:8080}
  auth:
    url: ${AUTH_SERVICE_URL:http://localhost:8085}

# Cache Configuration
cache:
  ttl:
    user-profile: 3600        # 1 hour
    recommendations: 21600    # 6 hours
    anime-details: 3600       # 1 hour

# Scheduler Configuration
scheduler:
  notification:
    check-interval: "0 0 * * * ?"  # Every hour
    cleanup-interval: "0 0 2 * * ?" # 2 AM daily
  recommendation:
    cache-refresh: "0 0 3 * * ?"   # 3 AM daily

# Feature Flags
features:
  notifications:
    enabled: true
  recommendations:
    enabled: true
  continue-watching:
    max-items: 20

logging:
  level:
    com.animeflix.userservice: DEBUG
    org.springframework.data.mongodb: INFO
    org.springframework.security: INFO

kafka:
  bootstrap-servers: localhost:9092
  consumer:
    group-id: user-service-notifications
    key-deserializer: org.apache.kafka.common.serialization.StringDeserializer
    value-deserializer: org.springframework.kafka.support.serializer.JsonDeserializer
    properties:
      spring.json.trusted.packages: com.animeflix.userservice.dto.kafka
  topics:
    new-episode: anime.episode.new